秒杀下单和普通下单区别
1、先扣取秒杀数据的库存，这里扣库存不是真正扣库存，只是为了拿个通行证
2、拿到通行证后，发送订单到订单中心，下单扣库存，成功发送消息通知秒杀成功
3、进行正常的下单流程，提交订单、扣库存，发送延迟队列等待支付
4、N分钟未支付进行订单关闭，库存回滚



redis高可用保障：
redis cluster集群
redis 主备

redis宕机，备用redis可能与mysql数据不一致，继续放过，能不能下单成功以扣mysql库存为准


    
不支付或取消订单回滚库存：
1、关闭订单
2、回滚数据库库存，回滚redis库存
3.1、redis发布订阅消息，通知所有应用，删除库存为空的标志(时效性高)
3.2、应用库存为0，定时任务每秒查询一次redis，查看是否有库存(简单)



非秒杀场景：
1、先生成订单
2、扣减库存
3、支付
